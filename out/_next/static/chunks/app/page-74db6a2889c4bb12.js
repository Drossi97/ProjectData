(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4719:function(e,t,a){Promise.resolve().then(a.bind(a,8769))},8769:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return z}});var n=a(288),r=a(5192),s=a(5001),l=a(7940),i=a(9773),o=a(7009);function d(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,o.m6)((0,i.W)(t))}let c=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:t,variant:a,size:r,asChild:l=!1,...i}=e,o=l?s.g7:"button";return(0,n.jsx)(o,{"data-slot":"button",className:d(c({variant:a,size:r,className:t})),...i})}function m(e){let{className:t,...a}=e;return(0,n.jsx)("div",{"data-slot":"card",className:d("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function x(e){let{className:t,...a}=e;return(0,n.jsx)("div",{"data-slot":"card-header",className:d("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function f(e){let{className:t,...a}=e;return(0,n.jsx)("div",{"data-slot":"card-title",className:d("leading-none font-semibold",t),...a})}function h(e){let{className:t,...a}=e;return(0,n.jsx)("div",{"data-slot":"card-content",className:d("px-6",t),...a})}function g(e){let{className:t,type:a,...r}=e;return(0,n.jsx)("input",{type:a,"data-slot":"input",className:d("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}var p=a(1302);function v(e){let{className:t,...a}=e;return(0,n.jsx)(p.f,{"data-slot":"label",className:d("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}var b=a(1868),j=a(1207);function y(e){let{files:t,onFilesChange:a,onAnalyze:s,isProcessing:l}=e,[i,o]=(0,r.useState)(!1),d=e=>{let n=e.filter(e=>e.name.toLowerCase().endsWith(".csv")||"text/csv"===e.type).filter(e=>!t.some(t=>t.name===e.name&&t.size===e.size));a([...t,...n])},c=e=>{a(t.filter((t,a)=>a!==e))};return(0,n.jsx)(m,{style:{backgroundColor:"#171717",borderColor:"#2C2C2C"},children:(0,n.jsxs)(h,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"w-full h-40 border-2 border-dashed rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all duration-300 relative ".concat(i?"border-blue-400 bg-blue-500/10":"border-gray-600 hover:border-gray-500 hover:bg-gray-700/30"),style:{backgroundColor:"#2C2C2C"},onDragOver:e=>{e.preventDefault(),o(!0)},onDragLeave:e=>{e.preventDefault(),o(!1)},onDrop:e=>{e.preventDefault(),o(!1),d(Array.from(e.dataTransfer.files))},onClick:()=>{var e;return null===(e=document.getElementById("files"))||void 0===e?void 0:e.click()},children:[(0,n.jsx)(g,{id:"files",type:"file",multiple:!0,accept:".csv,text/csv",onChange:e=>{d(Array.from(e.target.files||[])),e.target.value=""},className:"hidden"}),(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-3",children:[(0,n.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center shadow-md",style:{backgroundColor:"#374151"},children:(0,n.jsx)(b.Z,{className:"h-6 w-6 text-gray-200"})}),(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("p",{className:"text-sm text-gray-300 font-medium",children:i?"Soltar archivos aqu\xed":"Arrastra archivos CSV aqu\xed"}),(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"o haz clic para seleccionar"})]})]}),i&&(0,n.jsx)("div",{className:"absolute inset-0 border-2 border-blue-400 border-dashed rounded-xl bg-blue-500/20 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"w-8 h-8 mx-auto mb-2 rounded-full bg-blue-400 flex items-center justify-center",children:(0,n.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),(0,n.jsx)("p",{className:"text-blue-300 font-medium",children:"Soltar para subir"})]})})]}),t.length>0&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)(v,{className:"text-white font-medium",children:["Archivos seleccionados (",t.length,"):"]}),(0,n.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>(0,n.jsxs)("div",{className:"w-full flex items-center justify-between gap-2 p-3 rounded-xl transition-all duration-200",style:{backgroundColor:"#2C2C2C"},children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,n.jsx)(b.Z,{className:"h-4 w-4 text-gray-200 flex-shrink-0"}),(0,n.jsx)("span",{className:"text-sm text-white font-medium truncate",title:e.name,children:e.name})]}),(0,n.jsx)(u,{variant:"ghost",size:"sm",onClick:()=>c(t),className:"h-6 w-6 p-0 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded-xl flex-shrink-0 transition-all duration-200",children:(0,n.jsx)(j.Z,{className:"h-3 w-3"})})]},"".concat(e.name,"-").concat(t)))})]})]}),(0,n.jsx)("div",{className:"flex justify-start",children:(0,n.jsx)(u,{onClick:s,disabled:0===t.length||l,className:"bg-white hover:bg-gray-50 text-black font-medium py-3 px-6 rounded-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed border border-gray-200",children:l?"Procesando...":"Procesar Datos"})})]})})}var N=a(3140),C=a(8090),w=a(6689),k=a(3587),S=a(6289),D=a(5067),M=a(5250),T=a(722);function I(e){var t;let{results:a}=e;if(!a||!a.success||!a.data)return null;let s=(e,t,a)=>{if(!t||!a)return{type:"undefined",description:"undefined - no port data available"};let n=t.name===a.name,r=t.distance<4,s=a.distance<4,l=t.distance<10,i=a.distance<10,o=Math.max(t.distance,a.distance)>40;return"0.0"===e&&n&&r&&s?{type:"docked",description:"docked at ".concat(t.name),atPort:t.name}:"1.0"===e&&n&&l&&i?{type:"maneuvering",description:"maneuvering at ".concat(t.name),atPort:t.name}:"2.0"!==e||n?{type:"undefined",description:o?"Estado indefinido - demasiado lejos de puertos (> 40 km)":"Estado indefinido - condiciones no cumplidas"}:{type:"transit",description:"in transit from ".concat(t.name," to ").concat(a.name),fromPort:t.name,toPort:a.name}},[l,i]=(0,r.useState)({speed:!0,navStatus:!0}),[o,d]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[g,p]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),j=(0,r.useMemo)(()=>{var e;let t=[];if(!(null===(e=a.data)||void 0===e?void 0:e.intervals)||0===a.data.intervals.length)return t;let n=[...a.data.intervals].sort((e,t)=>new Date("".concat(e.startDate," ").concat(e.startTime)).getTime()-new Date("".concat(t.startDate," ").concat(t.startTime)).getTime());return n.forEach((e,a)=>{let r=new Date("".concat(e.startDate," ").concat(e.startTime)).getTime(),l=new Date("".concat(e.endDate," ").concat(e.endTime)).getTime(),i=s(e.navStatus,e.startPort,e.endPort);if(a>0){let e=n[a-1],s=new Date("".concat(e.endDate," ").concat(e.endTime)).getTime();(r-s)/1e3>.6&&t.push({time:new Date(s).toTimeString().split(" ")[0].substring(0,8),date:e.endDate,timestamp:s,speed:null,navStatus:"sin datos",navStatusValue:null,isGap:!0})}let o=l-r;t.push({time:e.startTime,date:e.startDate,timestamp:r,speed:e.avgSpeed,navStatus:e.navStatus,navStatusValue:parseInt(e.navStatus)||0,classification:i,intervalStartTime:e.startTime,intervalEndTime:e.endTime,intervalStartDate:e.startDate,intervalEndDate:e.endDate,duration:e.duration,isStartPoint:!0});let d=r+o/2;t.push({time:new Date(d).toTimeString().split(" ")[0].substring(0,8),date:e.startDate,timestamp:d,speed:e.avgSpeed,navStatus:e.navStatus,navStatusValue:parseInt(e.navStatus)||0,classification:i,intervalStartTime:e.startTime,intervalEndTime:e.endTime,intervalStartDate:e.startDate,intervalEndDate:e.endDate,duration:e.duration,isCenterPoint:!0}),t.push({time:e.endTime,date:e.endDate,timestamp:l,speed:e.avgSpeed,navStatus:e.navStatus,navStatusValue:parseInt(e.navStatus)||0,classification:i,intervalStartTime:e.startTime,intervalEndTime:e.endTime,intervalStartDate:e.startDate,intervalEndDate:e.endDate,duration:e.duration,isEndPoint:!0})}),t.sort((e,t)=>e.timestamp-t.timestamp)},[a.data.intervals]),y=(0,r.useMemo)(()=>o?j.slice(o.startIndex,o.endIndex+1):j,[j,o]),I=e=>{i(t=>({...t,[e]:!t[e]}))},A=e=>{let t=j.length;if(e){if(o){let e=o.endIndex-o.startIndex;if(e>20){let t=Math.floor(.25*e);d({startIndex:o.startIndex+t,endIndex:o.endIndex-t})}}else{let e=Math.floor(.6*t),a=Math.max(0,Math.floor(t/2)-Math.floor(e/2));d({startIndex:a,endIndex:Math.min(t-1,a+e)})}}else{if(!o)return;let e=Math.floor(.3*(o.endIndex-o.startIndex)),a=Math.max(0,o.startIndex-e),n=Math.min(t-1,o.endIndex+e);n-a>=.9*t?d(null):d({startIndex:a,endIndex:n})}},_=()=>{u(!1),p(null)},P=y.map(e=>e.speed).filter(e=>null!==e),E=y.map(e=>e.navStatusValue).filter(e=>null!==e),F=P.length>0?Math.min(...P):0,B=P.length>0?Math.max(...P):10,L=E.length>0?Math.min(...E,0):0,z=E.length>0?Math.max(...E,2):2,G=e=>{if(!e||"--:--:--"===e)return"--:--:--";if("string"!=typeof e)return String(e||"--:--:--");let t=e.split(":").map(Number);if(3!==t.length||t.some(isNaN))return e;let a=t[0],n=t[1],r=t[2];return"".concat(a,"h ").concat(n,"m ").concat(r,"s")},O=(0,r.useMemo)(()=>!v||v.isGap?null:v.intervalStartTime?{startTime:v.intervalStartTime,endTime:v.intervalEndTime,startDate:v.intervalStartDate,endDate:v.intervalEndDate,duration:v.duration,navStatus:v.navStatus,avgSpeed:v.speed,startPort:null,endPort:null}:null,[v]);return(0,n.jsxs)(m,{style:{backgroundColor:"#171717",borderColor:"#2C2C2C"},children:[(0,n.jsx)(x,{children:(0,n.jsx)(f,{className:"text-white text-xl font-semibold",children:"Intervalos por estado de navegaci\xf3n"})}),(0,n.jsx)(h,{children:(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,n.jsxs)("div",{className:"flex-1 min-w-0",onMouseDown:e=>{o&&(u(!0),p({x:e.clientX,y:e.clientY}))},onMouseMove:e=>{if(!c||!g||!o)return;let t=e.clientX-g.x,a=e.currentTarget.getBoundingClientRect().width||800,n=j.length,r=o.endIndex-o.startIndex,s=Math.round(t/a*r*2),l=o.startIndex-s,i=o.endIndex-s;l<0&&(l=0,i=r),i>n-1&&(l=(i=n-1)-r),d({startIndex:l,endIndex:i}),p({x:e.clientX,y:e.clientY})},onMouseUp:_,onMouseLeave:_,style:{cursor:c?"grabbing":o?"grab":"default",userSelect:"none"},children:[(0,n.jsx)("div",{className:"flex justify-end items-center mb-4 flex-wrap gap-4",children:(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsxs)("button",{onClick:()=>I("speed"),className:"flex items-center gap-2 transition-all duration-200 ".concat(l.speed?"text-blue-400":"text-gray-400 hover:text-blue-300"),children:[(0,n.jsx)("div",{className:"w-4 h-0.5 ".concat(l.speed?"bg-blue-400":"bg-gray-600")}),"Velocidad"]}),(0,n.jsxs)("button",{onClick:()=>I("navStatus"),className:"flex items-center gap-2 transition-all duration-200 ".concat(l.navStatus?"text-green-400":"text-gray-400 hover:text-green-300"),children:[(0,n.jsx)("div",{className:"w-4 h-0.5 ".concat(l.navStatus?"bg-green-400":"bg-gray-600")}),"Estado"]}),(0,n.jsx)("button",{onClick:()=>A(!0),className:"px-3 py-1 text-sm rounded-lg transition-all duration-200 hover:bg-gray-700",style:{backgroundColor:"#2C2C2C",color:"#9CA3AF"},children:"\uD83D\uDD0D+"}),(0,n.jsx)("button",{onClick:()=>A(!1),className:"px-3 py-1 text-sm rounded-lg transition-all duration-200 hover:bg-gray-700",style:{backgroundColor:"#2C2C2C",color:"#9CA3AF"},children:"\uD83D\uDD0D-"}),(0,n.jsx)("button",{onClick:()=>{d(null)},className:"px-3 py-1 text-sm rounded-lg transition-all duration-200 hover:bg-gray-700",style:{backgroundColor:"#2C2C2C",color:"#9CA3AF"},children:"↻"})]})}),(0,n.jsx)(N.h,{width:"100%",height:620,children:(0,n.jsxs)(C.w,{data:y,margin:{top:40,right:30,left:20,bottom:40},onMouseMove:e=>{e&&e.activePayload&&e.activePayload.length>0&&b(e.activePayload[0].payload)},onMouseLeave:()=>b(null),children:[(0,n.jsx)(w.q,{strokeDasharray:"3 3",stroke:"#2C2C2C",opacity:.3}),(0,n.jsx)(k.K,{xAxisId:"dates",dataKey:"date",orientation:"top",stroke:"#9CA3AF",fontSize:10,angle:0,textAnchor:"middle",height:30,interval:0,tickFormatter:(e,t)=>{let a=y[t];if(!a||!a.date)return e;if(t>0){let e=y[t-1];if(e&&e.date===a.date)return""}let[n,r,s]=a.date.split("-");return"".concat(s,"-").concat(r)},axisLine:!1,tickLine:!1}),(0,n.jsx)(k.K,{xAxisId:"times",dataKey:"time",orientation:"bottom",stroke:"#9CA3AF",fontSize:10,angle:0,textAnchor:"middle",height:30,interval:Math.floor(y.length/8),tickFormatter:(e,t)=>{let a=y[t];return!a||a.isGap?"":e.substring(0,5)+"h"}}),(0,n.jsx)(S.B,{yAxisId:"speed",orientation:"left",stroke:"#3B82F6",fontSize:12,domain:[F,B],label:{value:"Velocidad (nudos)",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"#3B82F6"}}}),(0,n.jsx)(S.B,{yAxisId:"status",orientation:"right",stroke:"#10B981",fontSize:12,domain:[L,z],type:"number",allowDecimals:!1,tickFormatter:e=>"".concat(Math.round(e)),label:{value:"Estado",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"#10B981"}}}),(0,n.jsx)(D.u,{cursor:!1,content:()=>null}),l.speed&&(0,n.jsx)(M.x,{xAxisId:"times",yAxisId:"speed",type:"stepAfter",dataKey:"speed",stroke:"#3B82F6",strokeWidth:2,dot:!1,connectNulls:!1}),l.navStatus&&(0,n.jsx)(M.x,{xAxisId:"times",yAxisId:"status",type:"stepAfter",dataKey:"navStatusValue",stroke:"#10B981",strokeWidth:3,dot:!1,connectNulls:!1}),(()=>{let e=[];return y.forEach((t,a)=>{if(t.isGap&&a<y.length-1){let n=y[a+1];n&&!n.isGap&&e.push({x1:t.timestamp,x2:n.timestamp,fill:"rgba(255, 255, 255, 0.1)",fillOpacity:.3})}}),e.map((e,t)=>(0,n.jsx)(T.z,{x1:e.x1,x2:e.x2,fill:e.fill,fillOpacity:e.fillOpacity},"gap-".concat(t)))})()]})})]}),(0,n.jsxs)("div",{className:"lg:w-40 space-y-3",children:[(0,n.jsxs)("div",{className:"text-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-bold text-white mb-2",children:"Informaci\xf3n de intervalos"}),(0,n.jsx)("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-600 to-transparent"})]}),(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:v&&!v.isGap?"#10B981":"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Estado"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-lg font-bold text-green-400 text-center",children:(null==v?void 0:v.isGap)?"Sin datos":(null==v?void 0:v.navStatus)||"--"})})]}),(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:v&&!v.isGap?"#8B5CF6":"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Actividad"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-sm font-bold text-purple-400 text-center",children:v&&!v.isGap&&(null==v?void 0:v.classification)?(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-xs text-center",children:["docked"===v.classification.type&&"ATRACADO","maneuvering"===v.classification.type&&"MANIOBRANDO","transit"===v.classification.type&&"TR\xc1NSITO","undefined"===v.classification.type&&"Estado indefinido"]}),v.classification.atPort&&(0,n.jsxs)("div",{className:"text-xs text-gray-300 mt-1 text-center",children:["en ",v.classification.atPort]}),v.classification.fromPort&&v.classification.toPort&&(0,n.jsxs)("div",{className:"text-xs text-gray-300 mt-1 text-center",children:[v.classification.fromPort," → ",v.classification.toPort]})]}):"--"})})]}),(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:v&&!v.isGap?"#3B82F6":"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Velocidad Media"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-lg font-bold text-blue-400 text-center",children:[v&&!v.isGap&&(null==v?void 0:null===(t=v.speed)||void 0===t?void 0:t.toFixed(2))||"--",(0,n.jsx)("span",{className:"text-xs font-normal ml-1",children:"kn"})]})})]}),(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Duraci\xf3n"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-sm font-bold text-orange-400 font-mono text-center",children:(null==O?void 0:O.duration)?(e=>{if(!e)return"--:--:--";if("number"==typeof e){if(0===e)return"--:--:--";let t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60);return t>0?"".concat(t,"d ").concat(a,"h ").concat(n,"m ").concat(r,"s"):a>0?"".concat(a,"h ").concat(n,"m ").concat(r,"s"):n>0?"".concat(n,"m ").concat(r,"s"):"".concat(r,"s")}let t=(e=>{if(!e||"--:--:--"===e)return 0;let t=e.split(":").map(Number);return 3!==t.length?0:3600*t[0]+60*t[1]+t[2]})(e);if(0===t)return"--:--:--";let a=Math.floor(t/86400),n=Math.floor(t%86400/3600),r=Math.floor(t%3600/60),s=Math.floor(t%60);return a>0?"".concat(a,"d ").concat(n,"h ").concat(r,"m ").concat(s,"s"):n>0?"".concat(n,"h ").concat(r,"m ").concat(s,"s"):r>0?"".concat(r,"m ").concat(s,"s"):"".concat(s,"s")})(O.duration):"--:--:--"})})]}),(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Hora Inicial"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-sm font-bold text-white font-mono text-center",children:(null==O?void 0:O.startTime)?G(O.startTime):"--:--:--"})})]}),(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Hora Final"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-sm font-bold text-white font-mono text-center",children:(null==O?void 0:O.endTime)?G(O.endTime):"--:--:--"})})]}),(0,n.jsxs)("div",{className:"pl-2 pr-2 pt-1 pb-2 rounded-md border h-20 flex flex-col",style:{backgroundColor:"#2C2C2C",borderColor:"#2C2C2C"},children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 leading-tight",children:"Fecha"}),(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-sm font-bold text-cyan-400 text-center",children:v&&!v.isGap?(e=>{if(!e||"--"===e)return"--";if("string"!=typeof e)return String(e||"--");let t=e.split("-");if(3!==t.length)return e;let[a,n,r]=t;return"".concat(r,"/").concat(n,"/").concat(a)})((null==v?void 0:v.date)||(null==O?void 0:O.startDate)||"--"):"--"})})]})]})]})]})})]})}var A=a(4258),_=a.n(A),P=a(3388),E=a(4636),F=a(5597);let B={docked_ceuta:"#6B7280",docked_algeciras:"#4B5563",docked_tangermed:"#374151",maneuvering_ceuta:"#F59E0B",maneuvering_algeciras:"#D97706",maneuvering_tangermed:"#B45309",transit_ceuta_algeciras:"#10B981",transit_ceuta_tangermed:"#059669",transit_algeciras_ceuta:"#047857",transit_algeciras_tangermed:"#065F46",transit_tangermed_ceuta:"#064E3B",transit_tangermed_algeciras:"#0F766E",undefined:"#EF4444"};function L(e){let{results:t}=e;if(!t||!t.success||!t.data)return null;let a=e=>{let t=e.split(":").map(Number);return 3!==t.length?0:3600*t[0]+60*t[1]+t[2]},r=e=>{let t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60);return t>0?"".concat(t,"d ").concat(a,"h ").concat(n,"m ").concat(r,"s"):a>0?"".concat(a,"h ").concat(n,"m ").concat(r,"s"):n>0?"".concat(n,"m ").concat(r,"s"):"".concat(r,"s")},s=(e,t,a)=>{let n=t.toLowerCase().replace(" ","").replace("tanger med","tangermed"),r=a?a.toLowerCase().replace(" ","").replace("tanger med","tangermed"):"";return"docked"===e?B["docked_".concat(n)]||"#6B7280":"maneuvering"===e?B["maneuvering_".concat(n)]||"#F59E0B":"transit"===e&&r&&B["transit_".concat(n,"_").concat(r)]||"#10B981"},l=Object.values(t.data.intervals.reduce((e,t)=>{let n=a(t.duration);if(!t.startPort||!t.endPort)return e;let r=t.startPort.name,l=t.endPort.name,i=t.navStatus,o=t.startPort.distance<4,d=t.endPort.distance<4,c=t.startPort.distance<10,u=t.endPort.distance<10,m=Math.max(t.startPort.distance,t.endPort.distance)>40;if("0.0"===i&&r===l&&o&&d){let t="docked_".concat(r.toLowerCase().replace(" ","").replace("tanger med","tangermed"));e.push({id:t,name:"Atracado en ".concat(r),duration:n,type:"docked",port:r,color:s("docked",r)})}else if("1.0"===i&&r===l&&c&&u){let t="maneuvering_".concat(r.toLowerCase().replace(" ","").replace("tanger med","tangermed"));e.push({id:t,name:"Maniobrando en ".concat(r),duration:n,type:"maneuvering",port:r,color:s("maneuvering",r)})}else if("2.0"===i&&r!==l){let t="".concat(r.toLowerCase().replace(" ","").replace("tanger med","tangermed"),"_").concat(l.toLowerCase().replace(" ","").replace("tanger med","tangermed"));e.push({id:"transit_".concat(t),name:"Navegando ".concat(r," → ").concat(l),duration:n,type:"transit",port:"".concat(r," → ").concat(l),color:s("transit",r,l)})}else e.push({id:"undefined",name:m?"Estado indefinido":"Indefinido",duration:n,type:"undefined",port:m?"Estado indefinido":"Desconocido",color:B.undefined});return e},[]).reduce((e,t)=>(e[t.id]||(e[t.id]={id:t.id,name:t.name,duration:0,type:t.type,port:t.port,color:t.color,count:0}),e[t.id].duration+=t.duration,e[t.id].count++,e),{})).map(e=>({id:e.id,name:e.name,value:e.duration,type:e.type,port:e.port,color:e.color})).sort((e,t)=>t.value-e.value);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_(),{id:"ecfe3ceda43c57f7",children:".custom-scrollbar.jsx-ecfe3ceda43c57f7{scrollbar-width:thin;scrollbar-color:#4B5563#2C2C2C}.custom-scrollbar.jsx-ecfe3ceda43c57f7::-webkit-scrollbar{width:8px}.custom-scrollbar.jsx-ecfe3ceda43c57f7::-webkit-scrollbar-track{background:#2C2C2C;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}.custom-scrollbar.jsx-ecfe3ceda43c57f7::-webkit-scrollbar-thumb{background:#4B5563;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px}.custom-scrollbar.jsx-ecfe3ceda43c57f7::-webkit-scrollbar-thumb:hover{background:#6B7280}"}),(0,n.jsxs)(m,{style:{backgroundColor:"#171717",borderColor:"#2C2C2C"},children:[(0,n.jsx)(x,{children:(0,n.jsx)(f,{className:"text-white text-xl font-semibold",children:"Distribuci\xf3n de la actividad del barco"})}),(0,n.jsx)(h,{children:(0,n.jsxs)("div",{className:"jsx-ecfe3ceda43c57f7 w-full",children:[(0,n.jsx)("div",{style:{height:"450px"},className:"jsx-ecfe3ceda43c57f7 w-full",children:(0,n.jsx)(N.h,{width:"100%",height:"100%",children:(0,n.jsxs)(P.u,{children:[(0,n.jsx)(E.b,{data:l,cx:"50%",cy:"50%",outerRadius:140,fill:"#8884d8",dataKey:"value",children:l.map((e,t)=>(0,n.jsx)(F.b,{fill:e.color},"cell-".concat(t)))}),(0,n.jsx)(D.u,{content:(0,n.jsx)(e=>{let{active:t,payload:a}=e;if(t&&a&&a.length){let e=a[0].payload,t=l.reduce((e,t)=>e+t.value,0),s=(e.value/t*100).toFixed(1);return(0,n.jsxs)("div",{className:"p-3 rounded-lg shadow-lg",style:{backgroundColor:"#2C2C2C"},children:[(0,n.jsx)("p",{className:"text-white font-medium",children:e.name}),(0,n.jsxs)("p",{className:"text-gray-300",children:[r(e.value)," (",s,"%)"]})]})}return null},{className:"jsx-ecfe3ceda43c57f7"})})]})})}),(0,n.jsx)("div",{className:"jsx-ecfe3ceda43c57f7 w-full mt-6",children:(0,n.jsx)("div",{className:"jsx-ecfe3ceda43c57f7 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 max-h-[800px] overflow-y-auto custom-scrollbar",children:l.map((e,t)=>{let a=l.reduce((e,t)=>e+t.value,0),s=(e.value/a*100).toFixed(1);return(0,n.jsxs)("div",{style:{backgroundColor:"#2C2C2C"},className:"jsx-ecfe3ceda43c57f7 p-4 rounded-md flex items-center justify-between w-full",children:[(0,n.jsxs)("div",{className:"jsx-ecfe3ceda43c57f7 flex items-center gap-4 flex-1 min-w-0",children:[(0,n.jsx)("div",{style:{backgroundColor:e.color},className:"jsx-ecfe3ceda43c57f7 w-5 h-5 rounded-full flex-shrink-0"}),(0,n.jsxs)("div",{className:"jsx-ecfe3ceda43c57f7 flex-1 min-w-0",children:[(0,n.jsx)("div",{className:"jsx-ecfe3ceda43c57f7 text-white font-medium text-base",children:e.port}),(0,n.jsx)("div",{className:"jsx-ecfe3ceda43c57f7 text-gray-400 text-sm",children:"docked"===e.type?"Atracado":"maneuvering"===e.type?"Maniobrando":"transit"===e.type?"Navegando":"Indefinido"})]})]}),(0,n.jsxs)("div",{className:"jsx-ecfe3ceda43c57f7 text-right flex-shrink-0 ml-4",children:[(0,n.jsx)("div",{className:"jsx-ecfe3ceda43c57f7 text-gray-300 font-medium text-base",children:r(e.value)}),(0,n.jsxs)("div",{className:"jsx-ecfe3ceda43c57f7 text-gray-400 text-sm",children:[s,"%"]})]})]},e.id)})})})]})})]})]})}function z(){let[e,t]=(0,r.useState)([]),{results:a,isProcessing:s,processFiles:l,clearResults:i}=function(){let[e,t]=(0,r.useState)(null),[a,n]=(0,r.useState)(!1),s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";try{let a="time",n=e=>{if(!e||"string"!=typeof e)return null;let t=e.split(" ");return t.length<2?null:{date:t[0],time:t[1],raw:e}},r=(e,t)=>{try{let a=new Date(e),n=new Date(t);if(Number.isNaN(a.getTime())||Number.isNaN(n.getTime()))return null;return Math.abs((n.getTime()-a.getTime())/1e3)}catch(e){return null}},s=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.6,n=r(e,t);return null!==n&&n>a},l=e=>{if(!e||0===e.trim().length)return[];let n=e.replace(/\r\n?/g,"\n").trim().split("\n");if(n.length<2)return[];let r="\\t"===t||"tab"===t?"	":t,s=n[0].split(r).map(e=>e.trim()),l=s.some(e=>e.toLowerCase().includes("navstatus")),i=s.some(e=>e.trim()===a);return l&&i?n.slice(1).map(e=>{let t=e.split(r).map(e=>e.trim()),a={};return s.forEach((e,n)=>{let r=t[n];a[e||"column_".concat(n)]=""===r||void 0===r?null:r}),a}):[]},i=e=>{if(!e)return{lat:null,lon:null};let t=Number.parseFloat(e["00-lathr [deg]"]),a=Number.parseFloat(e["01-lonhr [deg]"]);return{lat:Number.isNaN(t)?null:t,lon:Number.isNaN(a)?null:a}},o=e=>{if(!Array.isArray(e)||0===e.length)return null;let t=e.map(e=>{let t=null==e?void 0:e["04-speed [knots]"],a=""===t||null==t?Number.NaN:Number.parseFloat(t);return Number.isNaN(a)||a<0?null:a}).filter(e=>null!=e);if(0===t.length)return null;let a=t.reduce((e,t)=>e+t,0);return Math.round(a/t.length*100)/100},d=(e,t)=>{let a=new Date("2000-01-01T".concat(e)),n=new Date("2000-01-01T".concat(t));if(Number.isNaN(a.getTime())||Number.isNaN(n.getTime()))return"00:00:00";n<a&&n.setDate(n.getDate()+1);let r=Math.floor((n.getTime()-a.getTime())/1e3),s=String(Math.floor(r/3600)).padStart(2,"0"),l=String(Math.floor(r%3600/60)).padStart(2,"0"),i=String(r%60).padStart(2,"0");return"".concat(s,":").concat(l,":").concat(i)},c=[{name:"Algeciras",lat:36.128740148,lon:-5.439981128},{name:"Tanger Med",lat:35.880312709,lon:-5.515627045},{name:"Ceuta",lat:35.889,lon:-5.307}],u=(e,t,a,n)=>{let r=Math.PI/180*(a-e),s=Math.PI/180*(n-t),l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(Math.PI/180*e)*Math.cos(Math.PI/180*a)*Math.sin(s/2)*Math.sin(s/2);return Math.round(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*637100)/100},m=(e,t)=>{if(null===e||null===t)return;let a=c.map(a=>({name:a.name,distance:u(e,t,a.lat,a.lon)}));return a.sort((e,t)=>e.distance-t.distance),a[0]},x=[],f=[],h=[];for(let{name:t,content:a}of e)try{let e=l(a);0===e.length?h.push("Archivo sin datos v\xe1lidos: ".concat(t)):(x=x.concat(e),f.push({file:t,rows:e.length}))}catch(e){h.push("Error procesando ".concat(t,": ").concat(e instanceof Error?e.message:"Error desconocido"))}if(0===x.length)return{success:!1,error:"No se pudieron leer filas v\xe1lidas",meta:{processedFiles:f,errors:h}};let g=(e=>{if(!Array.isArray(e)||0===e.length)return[];let t=[],r=null,l=null,c=null,u=null,x=0,f=null;function h(a,n,s){let f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"status_change";if(!u||!r)return;let h=u.split(" ")[1],g=n.split(" ")[1],p=d(h,g),v=e.slice(x,a),b=o(v),j=e[x],y=e[a-1],N=i(j),C=i(y),w=m(N.lat,N.lon),k=m(C.lat,C.lon);t.push({startDate:c,startTime:l,endDate:s.date,endTime:s.time,navStatus:r,duration:p,avgSpeed:b,sampleCount:v.length,startLat:N.lat,startLon:N.lon,endLat:C.lat,endLon:C.lon,endReason:f,startPort:w,endPort:k})}if(e.forEach((t,i)=>{let o=null==t?void 0:t["06-navstatus [adim]"],d=null==t?void 0:t[a];if(!o||!d)return;let m=n(d);if(m){if(f&&s(f,d)){if(null!==r){let t=e[i-1],r=null==t?void 0:t[a],s=n(r);s&&h(i,r,s,"time_gap")}r=o,l=m.time,c=m.date,u=m.raw,x=i,f=d;return}if(null===r){r=o,l=m.time,c=m.date,u=m.raw,x=i,f=d;return}o!==r&&(h(i,d,m,"status_change"),r=o,l=m.time,c=m.date,u=m.raw,x=i),f=d}}),e.length>0&&null!=r){let t=e[e.length-1],r=null==t?void 0:t[a],s=n(r);s&&h(e.length,r,s,"end_of_data")}return t})(x);return{success:!0,data:{intervals:g,summary:{totalIntervals:g.length,totalRows:x.length,filesProcessed:f.length,navigationIntervals:g.filter(e=>"1.0"===e.navStatus).length,anchoredIntervals:g.filter(e=>"0.0"===e.navStatus).length}},meta:{processedFiles:f,errors:h}}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Error desconocido"}}};return{results:e,isProcessing:a,processFiles:async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if(0!==e.length){n(!0),t(null);try{let n=await Promise.all(e.map(async e=>{let t=await e.text();return{name:e.name,content:t}})),r=await s(n,a);t(r)}catch(e){t({success:!1,error:e instanceof Error?e.message:"Error desconocido al procesar archivos"})}finally{n(!1)}}},clearResults:()=>{t(null)},processCSVData:s}}();return(0,n.jsx)("div",{className:"min-h-screen",children:(0,n.jsxs)("div",{className:"container mx-auto p-6 space-y-6 max-w-7xl",children:[(0,n.jsx)(y,{files:e,onFilesChange:e=>{t(e),0===e.length&&i()},onAnalyze:()=>{l(e)},isProcessing:s}),(0,n.jsx)(I,{results:a}),(0,n.jsx)(L,{results:a})]})})}}},function(e){e.O(0,[821,24,240,744],function(){return e(e.s=4719)}),_N_E=e.O()}]);